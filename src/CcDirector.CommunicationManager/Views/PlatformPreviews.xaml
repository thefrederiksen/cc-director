<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                    xmlns:models="clr-namespace:CommunicationManager.Models"
                    xmlns:conv="clr-namespace:CommunicationManager.Converters">

    <conv:FilePathToImageSourceConverter x:Key="PathToImage"/>
    <conv:FirstMediaPathConverter x:Key="FirstMediaToImage"/>
    <conv:NullToVisibilityConverter x:Key="NullToVis"/>
    <conv:HtmlContentConverter x:Key="HtmlToText"/>
    <BooleanToVisibilityConverter x:Key="BoolToVis"/>

    <!-- LinkedIn Post Preview -->
    <DataTemplate x:Key="LinkedInPreviewTemplate" DataType="{x:Type models:ContentItem}">
        <Border Background="White" BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="8" Padding="16" MaxWidth="600">
            <StackPanel>
                <!-- Header: Avatar + Name -->
                <Grid Margin="0,0,0,12">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="48"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Avatar Circle -->
                    <Border Grid.Column="0" Width="48" Height="48" CornerRadius="24" Background="#0A66C2">
                        <TextBlock Text="UN" Foreground="White" FontWeight="Bold" FontSize="18"
                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>

                    <!-- Name and Headline -->
                    <StackPanel Grid.Column="1" Margin="12,0,0,0" VerticalAlignment="Center">
                        <TextBlock Text="User Name" FontWeight="SemiBold" FontSize="14"/>
                        <TextBlock Text="{Binding PersonaDisplay}" Foreground="#666" FontSize="12"/>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="2h" Foreground="#999" FontSize="11"/>
                            <TextBlock Text=" - " Foreground="#999" FontSize="11"/>
                            <TextBlock Text="[Globe icon]" Foreground="#999" FontSize="11"/>
                        </StackPanel>
                    </StackPanel>
                </Grid>

                <!-- Content -->
                <TextBlock Text="{Binding Content}" TextWrapping="Wrap" FontSize="14" LineHeight="20" Margin="0,0,0,12"/>

                <!-- Image (if present) -->
                <Border Margin="0,0,0,12" CornerRadius="4"
                        Visibility="{Binding Media, Converter={StaticResource NullToVis}}">
                    <Image Source="{Binding Media, Converter={StaticResource FirstMediaToImage}}"
                           Stretch="Uniform" MaxHeight="400"/>
                </Border>

                <!-- Engagement Stats -->
                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                    <Ellipse Width="16" Height="16" Fill="#0A66C2"/>
                    <TextBlock Text="47" Foreground="#666" FontSize="12" Margin="4,0,0,0"/>
                    <TextBlock Text=" likes" Foreground="#666" FontSize="12"/>
                    <TextBlock Text="  -  " Foreground="#999" FontSize="12"/>
                    <TextBlock Text="12 comments" Foreground="#666" FontSize="12"/>
                </StackPanel>

                <!-- Separator -->
                <Border Height="1" Background="#E0E0E0" Margin="0,4,0,8"/>

                <!-- Action Buttons -->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Orientation="Horizontal" HorizontalAlignment="Center">
                        <TextBlock Text="[+]" Foreground="#666" FontSize="16"/>
                        <TextBlock Text=" Like" Foreground="#666" FontSize="13" VerticalAlignment="Center" Margin="4,0,0,0"/>
                    </StackPanel>

                    <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Center">
                        <TextBlock Text="[o]" Foreground="#666" FontSize="16"/>
                        <TextBlock Text=" Comment" Foreground="#666" FontSize="13" VerticalAlignment="Center" Margin="4,0,0,0"/>
                    </StackPanel>

                    <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Center">
                        <TextBlock Text="[>]" Foreground="#666" FontSize="16"/>
                        <TextBlock Text=" Repost" Foreground="#666" FontSize="13" VerticalAlignment="Center" Margin="4,0,0,0"/>
                    </StackPanel>

                    <StackPanel Grid.Column="3" Orientation="Horizontal" HorizontalAlignment="Center">
                        <TextBlock Text="[=>]" Foreground="#666" FontSize="16"/>
                        <TextBlock Text=" Send" Foreground="#666" FontSize="13" VerticalAlignment="Center" Margin="4,0,0,0"/>
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Border>
    </DataTemplate>

    <!-- Twitter/X Preview -->
    <DataTemplate x:Key="TwitterPreviewTemplate" DataType="{x:Type models:ContentItem}">
        <Border Background="White" BorderBrush="#CFD9DE" BorderThickness="1" CornerRadius="16" Padding="16" MaxWidth="550">
            <StackPanel>
                <!-- Header -->
                <Grid Margin="0,0,0,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="40"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Avatar -->
                    <Border Grid.Column="0" Width="40" Height="40" CornerRadius="20" Background="#1DA1F2">
                        <TextBlock Text="UN" Foreground="White" FontWeight="Bold" FontSize="14"
                                   HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>

                    <!-- Name and Handle -->
                    <StackPanel Grid.Column="1" Margin="10,0,0,0" Orientation="Horizontal">
                        <TextBlock Text="User Name" FontWeight="Bold" FontSize="15"/>
                        <TextBlock Text=" @username" Foreground="#536471" FontSize="15"/>
                        <TextBlock Text=" - 2h" Foreground="#536471" FontSize="15"/>
                    </StackPanel>
                </Grid>

                <!-- Content -->
                <TextBlock Text="{Binding Content}" TextWrapping="Wrap" FontSize="15" LineHeight="20" Margin="0,0,0,12"/>

                <!-- Image -->
                <Border Margin="0,0,0,12" CornerRadius="16"
                        Visibility="{Binding Media, Converter={StaticResource NullToVis}}">
                    <Border.Clip>
                        <RectangleGeometry RadiusX="16" RadiusY="16" Rect="0,0,518,300"/>
                    </Border.Clip>
                    <Image Source="{Binding Media, Converter={StaticResource FirstMediaToImage}}"
                           Stretch="UniformToFill" MaxHeight="300"/>
                </Border>

                <!-- Action Buttons -->
                <Grid Margin="0,8,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <StackPanel Grid.Column="0" Orientation="Horizontal">
                        <TextBlock Text="[Reply]" Foreground="#536471" FontSize="13"/>
                        <TextBlock Text=" 3" Foreground="#536471" FontSize="13" Margin="4,0,0,0"/>
                    </StackPanel>

                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                        <TextBlock Text="[Repost]" Foreground="#536471" FontSize="13"/>
                        <TextBlock Text=" 8" Foreground="#536471" FontSize="13" Margin="4,0,0,0"/>
                    </StackPanel>

                    <StackPanel Grid.Column="2" Orientation="Horizontal">
                        <TextBlock Text="[Heart]" Foreground="#536471" FontSize="13"/>
                        <TextBlock Text=" 42" Foreground="#536471" FontSize="13" Margin="4,0,0,0"/>
                    </StackPanel>

                    <StackPanel Grid.Column="3" Orientation="Horizontal">
                        <TextBlock Text="[Views]" Foreground="#536471" FontSize="13"/>
                        <TextBlock Text=" 1.2K" Foreground="#536471" FontSize="13" Margin="4,0,0,0"/>
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Border>
    </DataTemplate>

    <!-- Reddit Preview -->
    <DataTemplate x:Key="RedditPreviewTemplate" DataType="{x:Type models:ContentItem}">
        <Border Background="White" BorderBrush="#EDEFF1" BorderThickness="1" CornerRadius="4" Padding="8" MaxWidth="600">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="40"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Vote Buttons -->
                <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                    <TextBlock Text="[^]" Foreground="#878A8C" FontSize="20" HorizontalAlignment="Center"/>
                    <TextBlock Text="24" Foreground="#1A1A1B" FontWeight="Bold" FontSize="12" HorizontalAlignment="Center"/>
                    <TextBlock Text="[v]" Foreground="#878A8C" FontSize="20" HorizontalAlignment="Center"/>
                </StackPanel>

                <!-- Content -->
                <StackPanel Grid.Column="1" Margin="8,0,0,0">
                    <!-- Subreddit Header -->
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,4">
                        <Border Width="20" Height="20" CornerRadius="10" Background="#FF4500">
                            <TextBlock Text="r" Foreground="White" FontSize="12"
                                       HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <TextBlock Text="{Binding RedditSpecific.Subreddit}" FontWeight="Bold" FontSize="12" Margin="4,0,0,0"/>
                        <TextBlock Text=" - Posted by u/username" Foreground="#787C7E" FontSize="12"/>
                        <TextBlock Text=" - 3h" Foreground="#787C7E" FontSize="12"/>
                    </StackPanel>

                    <!-- Title (for posts) -->
                    <TextBlock Text="{Binding RedditSpecific.Title}" FontWeight="SemiBold" FontSize="16"
                               TextWrapping="Wrap" Margin="0,0,0,8"
                               Visibility="{Binding RedditSpecific.Title, Converter={StaticResource NullToVis}}"/>

                    <!-- Content -->
                    <TextBlock Text="{Binding Content}" TextWrapping="Wrap" FontSize="14" LineHeight="20"/>

                    <!-- Actions -->
                    <StackPanel Orientation="Horizontal" Margin="0,12,0,0">
                        <TextBlock Text="[Comments] 8 Comments" Foreground="#878A8C" FontSize="12"/>
                        <TextBlock Text="   [Share]" Foreground="#878A8C" FontSize="12"/>
                        <TextBlock Text="   [Save]" Foreground="#878A8C" FontSize="12"/>
                    </StackPanel>
                </StackPanel>
            </Grid>
        </Border>
    </DataTemplate>

    <!-- Email Preview -->
    <DataTemplate x:Key="EmailPreviewTemplate" DataType="{x:Type models:ContentItem}">
        <Border Background="White" BorderBrush="#DADCE0" BorderThickness="1" CornerRadius="8" MaxWidth="650">
            <StackPanel>
                <!-- Email Header -->
                <Border Background="#F8F9FA" Padding="16" CornerRadius="8,8,0,0">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                            <TextBlock Text="From: " Foreground="#5F6368" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding SendFromDisplay}" Foreground="#202124"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                            <TextBlock Text="To: " Foreground="#5F6368" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding Recipient.Name}" Foreground="#202124"/>
                            <TextBlock Text=" &lt;" Foreground="#5F6368"/>
                            <TextBlock Text="{Binding EmailSpecific.To[0]}" Foreground="#5F6368"/>
                            <TextBlock Text="&gt;" Foreground="#5F6368"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,6">
                            <TextBlock Text="Subject: " Foreground="#5F6368" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding EmailSpecific.Subject}" Foreground="#202124" FontWeight="SemiBold"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="Send: " Foreground="#5F6368" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding SendTimingDisplay}" Foreground="#0A66C2" FontStyle="Italic"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- Attachments (if present) -->
                <Border Background="#F1F3F4" Padding="12,8" Margin="16,8,16,0"
                        CornerRadius="4" Visibility="{Binding HasAttachments, Converter={StaticResource BoolToVis}}">
                    <StackPanel>
                        <TextBlock Text="Attachments:" Foreground="#5F6368" FontSize="11"
                                   FontWeight="SemiBold" Margin="0,0,0,4"/>
                        <ItemsControl ItemsSource="{Binding AttachmentDisplayItems}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Button Command="{Binding OpenCommand}" Cursor="Hand"
                                            Background="Transparent" BorderThickness="0" Padding="0" Margin="0,2"
                                            HorizontalContentAlignment="Left">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="[+]" Foreground="#1565C0" FontSize="12" Margin="0,0,4,0"/>
                                            <TextBlock Text="{Binding DisplayText}" Foreground="#1565C0" FontSize="12"
                                                       TextDecorations="Underline"/>
                                        </StackPanel>
                                    </Button>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </StackPanel>
                </Border>

                <!-- Email Body -->
                <Border Padding="16">
                    <TextBlock Text="{Binding Content, Converter={StaticResource HtmlToText}}"
                               TextWrapping="Wrap" FontSize="14"
                               LineHeight="22" Foreground="#202124" FontFamily="Arial"/>
                </Border>
            </StackPanel>
        </Border>
    </DataTemplate>

    <!-- Article/Blog Preview -->
    <DataTemplate x:Key="ArticlePreviewTemplate" DataType="{x:Type models:ContentItem}">
        <Border Background="White" BorderBrush="#E0E0E0" BorderThickness="1" CornerRadius="4" MaxWidth="700">
            <StackPanel>
                <!-- Cover Image -->
                <Border Visibility="{Binding ArticleSpecific.CoverImage, Converter={StaticResource NullToVis}}">
                    <Image Source="{Binding ArticleSpecific.CoverImage, Converter={StaticResource PathToImage}}"
                           Stretch="UniformToFill" MaxHeight="300"/>
                </Border>

                <StackPanel Margin="24">
                    <!-- Title -->
                    <TextBlock Text="{Binding ArticleSpecific.Title}" FontSize="28" FontWeight="Bold"
                               TextWrapping="Wrap" Margin="0,0,0,8" LineHeight="34"/>

                    <!-- Subtitle -->
                    <TextBlock Text="{Binding ArticleSpecific.Subtitle}" FontSize="16" Foreground="#666"
                               TextWrapping="Wrap" Margin="0,0,0,16"
                               Visibility="{Binding ArticleSpecific.Subtitle, Converter={StaticResource NullToVis}}"/>

                    <!-- Author Info -->
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,20">
                        <Border Width="40" Height="40" CornerRadius="20" Background="#0A66C2">
                            <TextBlock Text="UN" Foreground="White" FontWeight="Bold" FontSize="14"
                                       HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <StackPanel Margin="12,0,0,0" VerticalAlignment="Center">
                            <TextBlock Text="User Name" FontWeight="SemiBold"/>
                            <TextBlock Text="{Binding PersonaDisplay}" Foreground="#666" FontSize="12"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Content (basic formatting) -->
                    <TextBlock Text="{Binding Content}" TextWrapping="Wrap" FontSize="16"
                               LineHeight="26" Foreground="#333"/>

                    <!-- Reading time -->
                    <StackPanel Orientation="Horizontal" Margin="0,20,0,0">
                        <TextBlock Text="{Binding ArticleSpecific.ReadingTimeMinutes}" Foreground="#666"/>
                        <TextBlock Text=" min read" Foreground="#666"/>
                        <TextBlock Text="  -  " Foreground="#999"/>
                        <TextBlock Text="{Binding ArticleSpecific.WordCount}" Foreground="#666"/>
                        <TextBlock Text=" words" Foreground="#666"/>
                    </StackPanel>
                </StackPanel>
            </StackPanel>
        </Border>
    </DataTemplate>

    <!-- Default/Fallback Preview -->
    <DataTemplate x:Key="DefaultPreviewTemplate" DataType="{x:Type models:ContentItem}">
        <Border Background="#F8F9FA" CornerRadius="4" Padding="16">
            <StackPanel>
                <!-- Platform Badge -->
                <Border Background="#0078D4" CornerRadius="4" Padding="8,4" HorizontalAlignment="Left" Margin="0,0,0,12">
                    <TextBlock Text="{Binding Platform}" Foreground="White" FontWeight="SemiBold"/>
                </Border>

                <!-- Content -->
                <TextBlock Text="{Binding Content}" TextWrapping="Wrap" FontSize="14" LineHeight="20"/>

                <!-- Image -->
                <Border Margin="0,12,0,0" CornerRadius="4"
                        Visibility="{Binding Media, Converter={StaticResource NullToVis}}">
                    <Image Source="{Binding Media, Converter={StaticResource FirstMediaToImage}}"
                           Stretch="Uniform" MaxHeight="400"/>
                </Border>
            </StackPanel>
        </Border>
    </DataTemplate>

</ResourceDictionary>
