<UserControl x:Class="CcDirector.Wpf.Controls.ImageViewerControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="#1E1E1E">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <!-- Toolbar -->
        <Border Grid.Row="0" Background="#252526" Padding="8,4" BorderBrush="#3C3C3C" BorderThickness="0,0,0,1">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <!-- File path + image info -->
                <DockPanel Grid.Column="0" VerticalAlignment="Center">
                    <TextBlock x:Name="ImageInfoText" DockPanel.Dock="Right"
                               Foreground="#666666" FontSize="11"
                               Margin="12,0,8,0" />
                    <TextBlock x:Name="FilePathText"
                               Foreground="#888888" FontSize="11"
                               TextTrimming="CharacterEllipsis"
                               ToolTip="{Binding Text, RelativeSource={RelativeSource Self}}" />
                </DockPanel>

                <!-- Zoom controls -->
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <Button Content="Fit" FontSize="11" Padding="8,2"
                            Background="#3C3C3C" Foreground="#CCCCCC"
                            BorderThickness="0" Cursor="Hand"
                            Margin="0,0,4,0"
                            Click="FitButton_Click">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#505050" />
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                    <Button Content="100%" FontSize="11" Padding="8,2"
                            Background="#3C3C3C" Foreground="#CCCCCC"
                            BorderThickness="0" Cursor="Hand"
                            Margin="0,0,4,0"
                            Click="ActualSizeButton_Click">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#505050" />
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                    <Button Content="-" FontSize="11" Padding="8,2"
                            Background="#3C3C3C" Foreground="#CCCCCC"
                            BorderThickness="0" Cursor="Hand"
                            Margin="0,0,4,0"
                            Click="ZoomOutButton_Click">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#505050" />
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                    <TextBlock x:Name="ZoomLevelText"
                               Foreground="#AAAAAA" FontSize="11"
                               VerticalAlignment="Center" Margin="0,0,4,0"
                               MinWidth="36" TextAlignment="Center" />
                    <Button Content="+" FontSize="11" Padding="8,2"
                            Background="#3C3C3C" Foreground="#CCCCCC"
                            BorderThickness="0" Cursor="Hand"
                            Click="ZoomInButton_Click">
                        <Button.Style>
                            <Style TargetType="Button">
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#505050" />
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Image area with checkerboard background for transparency -->
        <ScrollViewer x:Name="ImageScrollViewer" Grid.Row="1"
                      HorizontalScrollBarVisibility="Auto"
                      VerticalScrollBarVisibility="Auto"
                      PreviewMouseWheel="ImageScrollViewer_PreviewMouseWheel">
            <Border Background="#1E1E1E" HorizontalAlignment="Center" VerticalAlignment="Center">
                <!-- Checkerboard drawn via visual brush behind the image -->
                <Grid>
                    <Border x:Name="CheckerboardBorder">
                        <Border.Background>
                            <DrawingBrush TileMode="Tile" Viewport="0,0,16,16" ViewportUnits="Absolute">
                                <DrawingBrush.Drawing>
                                    <DrawingGroup>
                                        <GeometryDrawing Brush="#2A2A2A">
                                            <GeometryDrawing.Geometry>
                                                <RectangleGeometry Rect="0,0,16,16" />
                                            </GeometryDrawing.Geometry>
                                        </GeometryDrawing>
                                        <GeometryDrawing Brush="#333333">
                                            <GeometryDrawing.Geometry>
                                                <GeometryGroup>
                                                    <RectangleGeometry Rect="0,0,8,8" />
                                                    <RectangleGeometry Rect="8,8,8,8" />
                                                </GeometryGroup>
                                            </GeometryDrawing.Geometry>
                                        </GeometryDrawing>
                                    </DrawingGroup>
                                </DrawingBrush.Drawing>
                            </DrawingBrush>
                        </Border.Background>
                        <Image x:Name="ImageDisplay"
                               RenderOptions.BitmapScalingMode="HighQuality"
                               Stretch="None">
                            <Image.LayoutTransform>
                                <ScaleTransform x:Name="ImageScale" ScaleX="1" ScaleY="1" />
                            </Image.LayoutTransform>
                        </Image>
                    </Border>
                </Grid>
            </Border>
        </ScrollViewer>

        <!-- Loading overlay -->
        <TextBlock x:Name="LoadingText" Grid.Row="1"
                   Text="Loading..."
                   Foreground="#888888" FontSize="14"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center"
                   Visibility="Collapsed" />
    </Grid>
</UserControl>
