<Window x:Class="CcDirector.Wpf.AccountsDialog"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Claude Accounts"
        Width="520" MinHeight="300" SizeToContent="Height"
        MaxHeight="600"
        WindowStartupLocation="CenterOwner"
        ResizeMode="NoResize"
        Background="#252526">

    <StackPanel Margin="20">
        <!-- Add account buttons -->
        <Grid Margin="0,0,0,4">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="8" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Button Grid.Column="0" Content="Capture Current"
                    Click="BtnCapture_Click"
                    Height="32"
                    Background="#007ACC" Foreground="White"
                    BorderThickness="0" Cursor="Hand"
                    FontSize="12" FontWeight="SemiBold"
                    ToolTip="Read token from ~/.claude/.credentials.json" />
            <Button Grid.Column="2" Content="Add from JSON..."
                    Click="BtnAddFromJson_Click"
                    Height="32"
                    Background="#3C3C3C" Foreground="#CCCCCC"
                    BorderThickness="0" Cursor="Hand"
                    FontSize="12" FontWeight="SemiBold"
                    ToolTip="Paste credentials JSON from any account" />
        </Grid>
        <TextBlock Text="Capture reads the current ~/.claude/.credentials.json. Add from JSON lets you paste credentials from any source (e.g. a different browser profile)."
                   Foreground="#888888" FontSize="11" Margin="0,0,0,16"
                   TextWrapping="Wrap" />

        <!-- Account list -->
        <ItemsControl x:Name="AccountList">
            <ItemsControl.ItemTemplate>
                <DataTemplate>
                    <Border Background="#1E1E1E" CornerRadius="4" Padding="12,10"
                            Margin="0,0,0,8" BorderBrush="#3C3C3C" BorderThickness="1">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                                <RowDefinition Height="Auto" />
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="Auto" />
                            </Grid.ColumnDefinitions>

                            <!-- Row 0: Label + Active indicator + Tier -->
                            <StackPanel Grid.Row="0" Grid.Column="0" Orientation="Horizontal">
                                <TextBlock Text="{Binding Label}" Foreground="#CCCCCC"
                                           FontSize="14" FontWeight="SemiBold"
                                           VerticalAlignment="Center" />
                                <Border Background="#28A745" CornerRadius="2" Padding="4,1" Margin="8,0,0,0"
                                        VerticalAlignment="Center"
                                        Visibility="{Binding ActiveVisibility}">
                                    <TextBlock Text="active" Foreground="White" FontSize="9" FontWeight="SemiBold" />
                                </Border>
                            </StackPanel>
                            <TextBlock Grid.Row="0" Grid.Column="1"
                                       Text="{Binding TierDisplay}"
                                       Foreground="#569CD6" FontSize="12" FontWeight="SemiBold"
                                       VerticalAlignment="Center"
                                       HorizontalAlignment="Right" />

                            <!-- Row 1: Token expiry -->
                            <TextBlock Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2"
                                       Text="{Binding ExpiryDisplay}"
                                       Foreground="#888888" FontSize="11"
                                       Margin="0,4,0,0" />

                            <!-- Row 2: Action buttons -->
                            <StackPanel Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="2"
                                        Orientation="Horizontal" Margin="0,8,0,0">
                                <Button Content="Rename" Tag="{Binding Id}"
                                        Click="BtnRename_Click"
                                        Padding="8,3" Margin="0,0,6,0"
                                        Background="#3C3C3C" Foreground="#CCCCCC"
                                        BorderThickness="0" Cursor="Hand" FontSize="11" />
                                <Button Content="Remove" Tag="{Binding Id}"
                                        Click="BtnRemove_Click"
                                        Padding="8,3"
                                        Background="#5A1D1D" Foreground="#E88888"
                                        BorderThickness="0" Cursor="Hand" FontSize="11" />
                            </StackPanel>
                        </Grid>
                    </Border>
                </DataTemplate>
            </ItemsControl.ItemTemplate>
        </ItemsControl>

        <!-- Empty state message -->
        <TextBlock x:Name="EmptyMessage"
                   Text="No accounts configured. Click 'Capture Current Account' to add one."
                   Foreground="#666666" FontSize="12"
                   HorizontalAlignment="Center" Margin="0,12,0,12"
                   Visibility="Collapsed" />

        <!-- Close button -->
        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,12,0,0">
            <Button Content="Close" Click="BtnClose_Click"
                    Width="80" Height="30"
                    Background="#3C3C3C" Foreground="#CCCCCC"
                    BorderThickness="0" Cursor="Hand" />
        </StackPanel>
    </StackPanel>
</Window>
